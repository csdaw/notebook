<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 Python | A Minimal Book Example</title>
<meta name="author" content="John Doe">
<meta name="description" content="2.1 Environment setup on Unix Derived from https://ben11kehoe.medium.com/my-python-setup-77c57a2fc4b6 which is itself derived from https://jacobian.org/2019/nov/11/python-environment-2020/ Also...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="Chapter 2 Python | A Minimal Book Example">
<meta property="og:type" content="book">
<meta property="og:description" content="2.1 Environment setup on Unix Derived from https://ben11kehoe.medium.com/my-python-setup-77c57a2fc4b6 which is itself derived from https://jacobian.org/2019/nov/11/python-environment-2020/ Also...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 Python | A Minimal Book Example">
<meta name="twitter:description" content="2.1 Environment setup on Unix Derived from https://ben11kehoe.medium.com/my-python-setup-77c57a2fc4b6 which is itself derived from https://jacobian.org/2019/nov/11/python-environment-2020/ Also...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Minimal Book Example</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="hello-bookdown.html"><span class="header-section-number">1</span> Hello bookdown</a></li>
<li><a class="active" href="python.html"><span class="header-section-number">2</span> Python</a></li>
<li><a class="" href="git-and-github.html"><span class="header-section-number">3</span> Git and GitHub</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/csdaw/notebook">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="python" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Python<a class="anchor" aria-label="anchor" href="#python"><i class="fas fa-link"></i></a>
</h1>
<div id="environment-setup-on-unix" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Environment setup on Unix<a class="anchor" aria-label="anchor" href="#environment-setup-on-unix"><i class="fas fa-link"></i></a>
</h2>
<p>Derived from <a href="https://ben11kehoe.medium.com/my-python-setup-77c57a2fc4b6" class="uri">https://ben11kehoe.medium.com/my-python-setup-77c57a2fc4b6</a> which
is itself derived from <a href="https://jacobian.org/2019/nov/11/python-environment-2020/" class="uri">https://jacobian.org/2019/nov/11/python-environment-2020/</a></p>
<p>Also useful: <a href="https://lucasrla.github.io/python-on-macos/" class="uri">https://lucasrla.github.io/python-on-macos/</a></p>
<ol style="list-style-type: decimal">
<li><p>See system python version: <code>python3 --version</code></p></li>
<li><p>Install <a href="https://brew.sh">Homebrew</a></p></li>
<li><p>Install pyenv via Homebrew: <code>brew install pyenv</code></p></li>
<li><p>Follow the <a href="https://github.com/pyenv/pyenv#set-up-your-shell-environment-for-pyenv">Set up your shell environment for Pyenv</a> instructions.</p></li>
<li><p>Follow the <a href="https://github.com/pyenv/pyenv/wiki#suggested-build-environment">Suggested build environment</a> instructions.</p></li>
<li><p>See current python installations (should just be system): <code>pyenv versions</code></p></li>
<li><p>See list of available python versions in pyenv: <code>pyenv install --list</code></p></li>
<li><p>Check the latest python version <a href="https://www.python.org/downloads/">here</a></p></li>
<li><p>Install at least the latest version using pyenv: <code>pyenv install 3.10.6</code></p></li>
<li><p>Check current python installations again: <code>pyenv versions</code></p></li>
<li><p>Switch to the version you just installed: <code>pyenv global 3.10.6</code></p></li>
<li><p>List installed packages (should just be pip and setuptools): <code>pip list</code></p></li>
<li><p>You may be prompted to update pip: <code>pip install --upgrade pip</code></p></li>
<li><p>Install wheel: <code>pip install wheel</code></p></li>
<li><p>Install <a href="https://github.com/pypa/pipx">pipx</a> for installing Python-based CLI programs
e.g. youtube-dl: <code>pip install pipx</code></p></li>
<li><p>Run <code>pipx ensurepath</code> and restart shell.</p></li>
<li><p>Install poetry using pipx: <code>pipx install poetry</code></p></li>
<li>
<p>Run the following:</p>
<pre><code>poetry config --list
poetry config virtualenvs.create false
poetry config --list
ls ~/Library/Application\ Support/pypoetry
cat ~/Library/Application\ Support/pypoetry/config.toml
echo "export POETRY_VIRTUALENVS_IN_PROJECT=1" &gt;&gt; ~/.zshrc</code></pre>
</li>
<li><p>Install JupyterLab using pipx: <code>pipx install jupyterlab --include-deps</code></p></li>
<li><p>Create a conda config file: <code>echo "auto_update_conda: False" &gt;&gt; ~/.condarc</code></p></li>
<li><p>Install latest miniconda using pyenv: <code>pyenv install miniconda3-latest</code></p></li>
<li><p>Set enable python and miniconda at the same time (order is important!): <code>pyenv global 3.10.6 miniconda3-latest</code></p></li>
<li><p>Test that miniconda is working: <code>conda --version</code></p></li>
<li>
<p>Add some conda channels (in this order!):</p>
<pre><code>conda config --add channels defaults
conda config --add channels bioconda
conda config --add channels conda-forge
conda config --show-sources</code></pre>
</li>
<li><p>List conda envs (should be base only at this point): <code>conda env list</code></p></li>
<li><p>Set conda autoactivate base to false: <code>conda config --set auto_activate_base false</code></p></li>
<li><p>Initialise conda for using in shell: <code>conda init zsh</code></p></li>
</ol>
<div id="side-notes" class="section level3" number="2.1.1">
<h3>
<span class="header-section-number">2.1.1</span> Side-notes<a class="anchor" aria-label="anchor" href="#side-notes"><i class="fas fa-link"></i></a>
</h3>
<div id="pip" class="section level4" number="2.1.1.1">
<h4>
<span class="header-section-number">2.1.1.1</span> pip<a class="anchor" aria-label="anchor" href="#pip"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Find outdated packages: <code>pip list --outdated</code>
</li>
<li>Update an outdated package: <code>pip install name_of_pkg --upgrade</code>
</li>
</ul>
</div>
<div id="pipx" class="section level4" number="2.1.1.2">
<h4>
<span class="header-section-number">2.1.1.2</span> pipx<a class="anchor" aria-label="anchor" href="#pipx"><i class="fas fa-link"></i></a>
</h4>
<p>pipx is installed in a specific version of Python which is provided by pyenv.
Then tools installed via pipx are tied to that version. If you get rid of that
python version you may have issues and need to reinstall the tools using
<code>pipx reinstall-all</code>, possibly with the flag <code>--python xxx</code>. See
<a href="https://lucasrla.github.io/python-on-macos/pipx.html" class="uri">https://lucasrla.github.io/python-on-macos/pipx.html</a> for more info.</p>
<ul>
<li>No obvious way to list outdated packages</li>
<li>Update a package: <code>pipx upgrade name_of_pkg</code>
</li>
<li>Update all packages: <code>pipx upgrade-all</code>
</li>
</ul>
</div>
<div id="poetry" class="section level4" number="2.1.1.3">
<h4>
<span class="header-section-number">2.1.1.3</span> poetry<a class="anchor" aria-label="anchor" href="#poetry"><i class="fas fa-link"></i></a>
</h4>
<p>We have configured poetry to not create virtualenvs for you. I think I’ll just
use basic venv for now…</p>
<p>Update poetry: <code>pipx upgrade poetry</code>.</p>
<p>Uninstall poetry: <code>pipx uninstall poetry</code>.</p>
</div>
<div id="jupyterlab" class="section level4" number="2.1.1.4">
<h4>
<span class="header-section-number">2.1.1.4</span> jupyterlab<a class="anchor" aria-label="anchor" href="#jupyterlab"><i class="fas fa-link"></i></a>
</h4>
<p>Run jupyterlab: <code>jupyter lab</code></p>
<p>Check which python version is running:</p>
<pre><code>from platform import python_version

print(python_version())</code></pre>
<p>List installed packages (without a venv available, Jupyter will use the
‘global’ python version which in this case is the version we specified with <code>pyenv global</code>):
<code>!pip list</code></p>
<p>Update jupyterlab: <code>pipx upgrade jupyterlab --include-injected</code></p>
<p>Where do jupyter files live?: <code>jupyter --paths</code></p>
</div>
</div>
</div>
<div id="project-setup" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Project setup<a class="anchor" aria-label="anchor" href="#project-setup"><i class="fas fa-link"></i></a>
</h2>
<p>…</p>
<p><a href="https://github.com/drivendata/cookiecutter-data-science" class="uri">https://github.com/drivendata/cookiecutter-data-science</a></p>
<p><a href="https://ealizadeh.com/blog/guide-to-python-env-pkg-dependency-using-conda-poetry" class="uri">https://ealizadeh.com/blog/guide-to-python-env-pkg-dependency-using-conda-poetry</a></p>
<p><code>conda create -n env_name python=3.10</code>
<code>conda activate env_name</code></p>
<p>Now juypter is installed in its own little environment using pipx. But if we
run jupyter notebooks - <code>jupyter notebook</code> - from within our active conda environment,
then we have access to any python package pip installed into the conda env and
any conda package installed into the conda env.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="hello-bookdown.html"><span class="header-section-number">1</span> Hello bookdown</a></div>
<div class="next"><a href="git-and-github.html"><span class="header-section-number">3</span> Git and GitHub</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#python"><span class="header-section-number">2</span> Python</a></li>
<li>
<a class="nav-link" href="#environment-setup-on-unix"><span class="header-section-number">2.1</span> Environment setup on Unix</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#side-notes"><span class="header-section-number">2.1.1</span> Side-notes</a></li></ul>
</li>
<li><a class="nav-link" href="#project-setup"><span class="header-section-number">2.2</span> Project setup</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/csdaw/notebook/blob/master/02-python.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/csdaw/notebook/edit/master/02-python.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Minimal Book Example</strong>" was written by John Doe. It was last built on 2022-09-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
